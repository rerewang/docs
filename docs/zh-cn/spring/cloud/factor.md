# Factor App

## 认识
### 目的
- 为构建 SaaS 应用提供行之有效的方法论
	- 使用标准化流程自动配置，从而使新的开发者花费最少的学习成本加入这个项目。
	- 和操作系统之间尽可能的划清界限，在各个系统中提供最大的可移植性。
	- 适合部署在现代的云计算平台，从而在服务器和系统管理方面节省资源。
	- 将开发环境和生产环境的差异降至最低，并使用持续交付实施敏捷开发。
	- 可以在工具、架构和开发流程不发生明显变化的前提下实现扩展。
- 适用于任何语言和后端服务的开发的应用程序
- [The Twelve-Factor App](https://12factor.net/zh_cn/)

### 12-Factor
- 基准代码(Codebase)
	- 一份基准代码，多份部署
		- 使用版本控制系统加以管理
		- 基准代码和应用之间总是保持一一对应的关系
			- 一旦有多个基准代码，就不能称为一个应用，而是一个分布式系统。分布式系统中的每一个组件都是一个应用，每一个应用可以分别使用 12-Factor 进行开发。
			- 多个应用共享一份基准代码是有悖于 12-Factor 原则的。解决方案是将共享的代码拆分为独立的类库，然后使用*依赖管理*策略去加载它们。
- 依赖 (denpendencies)
	- 显式声明依赖关系
		- 12-Factor规则下的应用程序不会隐式依赖系统级的类库
		- 它一定通过*依赖清单*，确切地声明所有依赖项。
		- 在运行过程中通过*依赖隔离*工具来确保程序不会调用系统中存在但清单中未声明的依赖项
- 配置 (Config)
	- 在环境中存储配置
- 后端服务 (Backing Service)
	- 把后端服务当作附加资源
		- 后端服务是指程序运行所需要的通过网络调用的各种服务，如数据库（MySQL，CouchDB），消息/队列系统（RabbitMQ，Beanstalkd），SMTP 邮件发送服务（Postfix），以及缓存系统（Memcached）。
		- 12-Factor 应用不会区别对待本地或第三方服务
- 构建，发布，运行 (Build, release, run)
	- 严格分离构建和运行
		- 12-factor 应用严格区分构建，发布，运行这三个步骤
		- 部署工具通常都提供了发布管理工具
		- 每一个发布版本必须对应一个唯一的发布 ID
- 进程 (Processes)
	- 以一个或多个*无状态*进程运行应用
		- 12-Factor 应用的进程必须无状态且 无共享 
		- 任何需要持久化的数据都要存储在 后端服务 内
- 端口绑定 (Port binding)
	- 通过端口绑定提供服务
- 并发 (Concurrency)
	- 通过*进程模型*进行扩展
- 易处理 (Disposability)
	- 快速启动和优雅终止可最大化健壮性
		- 进程应当追求 最小启动时间
		- 进程 一旦接收 终止信号（SIGTERM） 就会优雅的终止
		- 进程还应当在面对突然死亡时保持健壮
- 开发环境与线上环境等价 (Dev/prod parity)
	- 尽可能的保持开发，预发布，线上环境相同
		- 想要做到 *持续部署* 就必须缩小本地与线上差异
		- *后端服务* 是保持开发与线上等价的重要部分
		- 12-Factor 应用的开发人员应该反对在不同环境间使用不同的后端服务
- 日志 (Logs)
	- 把日志当作事件流
- 管理进程 (Admin processes)
	- 后台管理任务当作一次性进程运行

